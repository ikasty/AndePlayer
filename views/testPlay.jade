include musicHeader.jade

div#mainContainer
  div.container
    div.wrapper
      div#logoArea
        |Ande Player
      div#buttonArea
        div#uploadButton.button 음악 올리기
        form#uploadMusicForm.hidden(action="/uploadMusic" method="post" enctype="multipart/form-data")
          input(type="file" name="musicFile")
          input(type="submit")
  div.container
    include musicPlayer.jade    
  div.container
    div#musicList.wrapper
      //- div.item= musicName
      each music in musicList
        div.item= music.name

script.
  (function () {
    $(document).ready(function () {
      var andeAudio;

      audiojs.events.ready(function () {
        andeAudio = audiojs.createAll();
        andeAudio = andeAudio[0];
        $('audio').load($('audio').attr('src'));
        $('.play').click();
      });
      
      $('#uploadButton').click(function () {
        $('input:file[name="musicFile"]').click();
      });
      $('input:file[name="musicFile"]').change(function () {
        $('#uploadMusicForm').submit();
      });

      $('#musicList .item').click(function() {
        $.ajax({
          type: 'get',
          url: '/getMusic',
          data: {name: $(this).html()},
          success: function(newMusic) {
            //- alert(newMusic.webPath);
            andeAudio.load(newMusic.webPath);
            andeAudio.play();
          }
        });
      });
    });
  })();